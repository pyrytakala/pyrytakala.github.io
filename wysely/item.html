<html>
<head>
	<link rel="stylesheet" href="styles.css">
	<script src="db.json"></script>
	<script src="db-active.json"></script>
	<script src="db-historical.json"></script>
	<script src="meta.json"></script>
	<script src="utils.js"></script>

</head>

<body>

<!-- Shared component -->
<div class='section header'>
	<div class='container'>
		<div class='container' id='header'>
			<div>
				<div class='header-logo'>
					<a href='index.html'>SuperGoodInvestor.com</a>
				</div>
				<div class='header-menu'>
					<a href=''>About us</a> &nbsp; <a href=''>Contact</a>
				</div>
			</div>
		</div>
	</div>
</div>



<div class='section'>
	<div class="container">
		<div class='single-col'>
				<h1 id='h1'></h1>
				<div style='text-align: center;'>
					<div id='meta-info'>
					</div>
				</div>
				<h3>Active responsibility signals</h3>
				<div class='container-flex' id='active-signals'>
				</div>
				<h3>&nbsp;<br><br><br>Historical responsibility signals</h3>
				<div class='container-flex' id='historical-signals'>
				</div>
		</div>
	</div>
</div>


<!-- Shared component -->
<div class='section footer'>
	<div class='container'>
		<div>
			@SuperGoodInvestor
		</div>
	</div>
</div>


<script>

const urlParams = new URLSearchParams(window.location.search);
id = urlParams.get('id')

function find_item(symbol) {
	for (i=0; i<db.length; i++) {
		if (db[i]['Symbol'] == symbol) {
			return db[i]
		}
	}
}

item = find_item(id)

// add heading and meta
cols = keysToList(item)

add = ''
cols.forEach(function(key) {

	document.getElementById('h1').innerHTML = item['Name']

	value = item[key]
	if (key in meta_index_attributes && !(key=='Name') && !(key=='Badges')) {

		add += "<div class='meta-item'>" + display(key, value, meta_index_attributes) + "</div>";
	}


//		if (col != "Name") {
//			add += "<div class='meta-item'><span class='label'>" + col + ": </span>" + item[col] + '</div>'		
//		}
});
document.getElementById('meta-info').innerHTML = add



// adding multis

function find_items(symbol, items_db) {
		found = []
		for (i=0; i<items_db.length; i++) {
			if (items_db[i]['Symbol'] == symbol) {
				found.push(items_db[i])
			}
		}
		return found
}

function add_badges(htmlid, items_db) {
	add = ''

	multis = find_items(id, items_db)

	multis.forEach(function(multi) {
		cols = keysToList(multi)
		colAdd = ''

		add += "<div class='multi'>"
		add += "<h3>" + multi["Stamp"] + "</h3>"
		add += "<div class='star'>" + starify(multi["OurScore"]) + "</div>"
		add += "<div>Score: " + multi["Score"] + "</div>"
		add += "<div>" + multi["Year"] + "</div>"
		add += "<div class='label'>" + multi["Program"] + "</div>"
		add += '</div>'
	});

	document.getElementById(htmlid).innerHTML = add
}

add_badges('active-signals', db_active)

add_badges('historical-signals', db_historical)

	  
</script>
</body>
</html>
